<section class="mat-typography">
  <div class="mat-elevation-z4" style="background:white">
    <h1 class="title mat-h1">
      <i>{{ (user | async)?.orgName }}</i> short links.
      <a
        style="color:#ababab; float:right"
        href="/__/api/linksv2/csv"
        download="links.csv"
      >
        <span class="material-icons">cloud_download</span>
      </a>
    </h1>
    <table mat-table [dataSource]="dataSource">
      <ng-container matColumnDef="link">
        <th mat-header-cell *matHeaderCellDef class="link header">
          SHORT LINK
        </th>
        <td
          mat-cell
          *matCellDef="let row; let i = index"
          class="shortlink-cell"
        >
          <div style="display: flex;flex-direction: row;">
            <a class="shortlink" href="/{{ row.link }}"
              >link.run/{{ row.link }}</a
            >
            <div
              class="shortlink-clipboard"
              style="display:flex; flex-direction:row"
            >
              <a
                matTooltip="Copy ShortLink"
                [hidden]="activeIndex != i"
                (click)="copyLink(row.link)"
                style="cursor:pointer;color:#ababab"
              >
                <span class="material-icons">content_copy</span>
              </a>
              <a
                matTooltip="Copy Public ShortLink"
                *ngIf="userObject.orgAllowsPublic"
                [hidden]="activeIndex != i"
                (click)="copyPublicLink(row.link)"
                style="cursor:pointer;color: orange"
              >
                <span class="material-icons">content_copy</span>
              </a>
            </div>
          </div>
        </td>
      </ng-container>

      <ng-container matColumnDef="url">
        <th mat-header-cell *matHeaderCellDef class="url header">URL</th>
        <td mat-cell *matCellDef="let row" class="url">
          <a href="/{{ row.url }}">{{ row.url }}</a>
        </td>
      </ng-container>

      <ng-container matColumnDef="createdby">
        <th mat-header-cell *matHeaderCellDef class="link header">
          CREATED BY
        </th>
        <td mat-cell *matCellDef="let row" class="link" style="flex: 0 0 25%">
          {{ row.userName }}
        </td>
      </ng-container>

      <ng-container matColumnDef="action">
        <th mat-header-cell *matHeaderCellDef class="action header">ACTION</th>
        <td mat-cell *matCellDef="let row; let i = index" class="action">
          <div style="display:flex; justify-content: flex-end;">
            <div style="color:#ababab" *ngIf="row['canEdit']">
              <a routerLink="/link/edit/{{ row.id }}" style="color:#ababab"
                ><span class="material-icons">edit</span></a
              >
            </div>
            <div style="color:#ababab" *ngIf="row['canEdit']">
              <a (click)="deleteLink(row.id)" style="cursor:pointer"
                ><span class="material-icons">delete</span></a
              >
            </div>
          </div>
        </td>
      </ng-container>

      <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
      <tr
        mat-row
        [class.highlight]="activeIndex == i"
        (mouseenter)="mouseEnter(i)"
        (mouseleave)="mouseLeave(i)"
        *matRowDef="let row; let i = index; columns: displayedColumns"
      ></tr>
    </table>
  </div>
</section>
